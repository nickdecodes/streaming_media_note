# 开篇



## 音视频知识



## 视频格式

#### 非编码格式

- YUV
- RGB

#### 编码格式

- h264
- h265
- vp8/vp9
- ...



### 音频格式

#### 非编码格式

- pcm

#### 编码格式

- aac
- mp3



### 字幕格式

- ASS
- SSA



### 视频封装格式

我们常见的视频封装格式有:`.mov、.avi、.mpg、.vob、.mkv、.rm、.rmvb `等等。为什么会有这么多种不同的文件格式？那是因为**它们通过不同的方式实现了视频这件事情**，至于这个不同在哪里，那就需要了解一下接下来要说的**「视频封装格式」**这个概念了

封装格式的主要作用是把视频码流和音频码流按照一定的格式存储在一个文件中。现如今流行的封装格式如下表所示

| 视频文件格式                             | 视频封装格式                       | 释义                                                         |
| ---------------------------------------- | ---------------------------------- | ------------------------------------------------------------ |
| .avi                                     | AVI(Audio Video Interleave)        | 图像质量好，但体积过于庞大，压缩标准不统一，存在高低版本兼容问题。 |
| .wmv                                     | WMV(Windows Media Video)           | 可边下载边播放，很适合网上播放和传输                         |
| .mpg .mpeg .mpe .dat .vob .asf .3gp .mp4 | MPEG(Moving Picture Experts Group) | 由运动图像专家组制定的视频格式，有三个压缩标准，分别是 MPEG-1、MPEG-2、和 MPEG-4，它为了播放流式媒体的高质量视频而专门设计的，以求使用最少的数据获得最佳的图像质量。 |
| .mkv                                     | Matroska                           | 一种新的视频封装格式，它可将多种不同编码的视频及 16 条以上不同格式的音频和不同语言的字幕流封装到一个 Matroska Media 文件当中。 |
| .rm、.rmvb                               | Real Video                         | Real Networks 公司所制定的音频视频压缩规范称为 Real Media。用户可以使用 RealPlayer 根据不同的网络传输速率制定出不同的压缩比率，从而实现在低速率的网络上进行影像数据实时传送和播放。 |
| .mov                                     | QuickTime File Format              | Apple 公司开发的一种视频格式，默认的播放器是苹果的 QuickTime。这种封装格式具有较高的压缩比率和较完美的视频清晰度等特点，并可以保存 alpha 通道。 |
| .flv                                     | Flash Video                        | 由 Adobe Flash 延伸出来的一种网络视频封装格式。这种格式被很多视频网站所采用。 |

| 视频文件格式 | 名称 | 推出机构           | 流媒体 | 支持的视频编码                 | 支持的音频编码                        | 目前使用领域   |
| ------------ | ---- | ------------------ | ------ | ------------------------------ | ------------------------------------- | -------------- |
| .avi         | AVI  | Microsoft Inc.     | 不支持 | 几乎所有格式                   | 几乎所有格式                          | BT下载影视     |
| .wmv         | MP4  | MPEG               | 支持   | MPEG-2, MPEG-4, H.264, H.263等 | AAC, MPEG-1 Layers I, II, III, AC-3等 | 互联网视频网站 |
|              | TS   | MPEG               | 支持   | MPEG-1, MPEG-2, MPEG-4, H.264  | MPEG-1 Layers I, II, III, AAC,        | IPTV，数字电视 |
| .flv         | FLV  | Adobe Inc.         | 支持   | Sorenson, VP6, H.264           | MP3, ADPCM, Linear PCM, AAC等         | 互联网视频网站 |
| .mkv         | MKV  | CoreCodec Inc.     | 支持   | 几乎所有格式                   | 几乎所有格式                          | 互联网视频网站 |
| .rm、.rmvb   | RMVB | Real Networks Inc. | 支持   | RealVideo 8, 9, 10             | AAC, Cook Codec, RealAudio Lossless   | BT下载影视     |



## 编解码

### 视频编码

视频编码的主要作用是将视频像素数据（RGB，YUV等）压缩成为视频码流，从而降低视频的数据量。如果视频不经过压缩编码的话，体积通常是非常大的，一部电影可能就要上百G的空间。视频编码是视音频技术中最重要的技术之一。视频码流的数据量占了视音频总数据量的绝大部分。高效率的视频编码在同等的码率下，可以获得更高的视频质量。主要视频编码如下表所示

| 名称        | 推出机构       | 推出时间 | 目前使用领域 |
| ----------- | -------------- | -------- | ------------ |
| HEVC(H.265) | MPEG/ITU-T     | 2013     | 研发中       |
| H.264       | MPEG/ITU-T     | 2003     | 各个领域     |
| MPEG4       | MPEG           | 2001     | 不温不火     |
| MPEG2       | MPEG           | 1994     | 数字电视     |
| VP9         | Google         | 2013     | 研发中       |
| VP8         | Google         | 2008     | 不普及       |
| VC-1        | Microsoft Inc. | 2006     | 微软平台     |



### 音频编码

 将音频采样数据（**PCM** 等）压缩成音频码流，从而降低音频的数据量。 常用的音频编码方式有以下几种

| 名称 | 推出机构       | 推出时间 | 目前使用领域   |
| ---- | -------------- | -------- | -------------- |
| AAC  | MPEG           | 1997     | 各个领域（新） |
| AC-3 | Dolby Inc.     | 1992     | 电影           |
| MP3  | MPEG           | 1993     | 各个领域（旧） |
| WMA  | Microsoft Inc. | 1999     | 微软平台       |



## 音视频库

- FFmpeg
- WebRTC
- MediaCodec
- ...



## （流媒体）[协议](./07.协议篇.md)

流媒体协议是服务器与客户端之间通信遵循的规定。当前网络上主要的流媒体协议如表所示。

| 名称              | 推出机构       | 传输层协议 | 客户端   | 目前使用领域    |
| ----------------- | -------------- | ---------- | -------- | --------------- |
| RTP & RTCP & RTSP | IETF           | TCP+UDP    | VLC, WMP | IPTV            |
| RTMP              | Adobe Inc.     | TCP        | Flash    | 互联网直播      |
| RTMFP             | Adobe Inc.     | UDP        | Flash    | 互联网直播      |
| MMS               | Microsoft Inc. | TCP/UDP    | WMP      | 互联网直播+点播 |
| HTTP              | WWW+IETF       | TCP        | Flash    | 互联网点播      |
| HLS               |                |            |          |                 |



## 客户端

- VLC
- ffplay
- ...



## [服务端](./08.服务器篇.md)

- nginx + rtmp
- srs
- live555
- Mediasoup（WebRTC）
- ...



## 拓展研究

- CDN
- 弱网优化
- ...

